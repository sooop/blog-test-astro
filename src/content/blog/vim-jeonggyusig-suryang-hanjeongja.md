---
created_at: 2025-02-12T14:53:31.000Z
feature_image: __GHOST_URL__/content/images/2025/02/photo-1608556984704-fa578c96e6eb.jpeg
published_date: 2025-02-14T01:23:06.000Z
slug: vim-jeonggyusig-suryang-hanjeongja
status: published
title: vim 정규식 수량 한정자
modified_date: 2025-02-14T01:23:06.000Z
custom_excerpt: vim 정규식 패턴의 고급사용법. 하지만 vim에서만 사용되니 알아둘 필요는 없습니다.
---
정규식 패턴 중 `a`는 a를 0번 이상 매치하는 '0개 이상'을 의미하는 수량 한정자입니다. 그런데 기본적으로 `*` 는 조건을 만족하는 가능한 많은 문자에 매칭됩니다. 한 쪽에서는 이러한 특성을 탐욕적(greedy)이라고 표현하기도 합니다. 보통은 a와 같은 특정한 글자보다는 다른 선택자나 그룹을 사용하는 경우가 더 많은데, 적절한 범위 내에서 원하는 부분만 정확하게 선택하려는 경우에는 이 탐욕적인 특성이 상당히 걸림돌로 작용하는 경우가 많습니다.

수량 한정자가 '가능한 적게' 매치하도록 하기 위해서는 뒤에 `?`을 붙입니다.

```
# 원문
color colour coloor colooour

# /colo.*r/
# .은 임의의 문자에 해당하고, 가장 많은 조건을 매치하려하기 때문에
# => |color colour coloor colooour| 와 매칭합니다. 

# /color.*?r/
# 가장 적은 조건에 매칭하기 때문에
# => |color| 와 매칭합니다. 
```

이는 현재 대다수의 정규식 문법에서 지원하는 방식이지만, vim에서는 이 문법을 지원하지 않습니다. vim 정규식에서 `?`는 "0 or 1"의 의미만 존재합니다.

그러나 대신 vim에서는 다른 방법으루 수량 한정자와 비슷한 기능을 사용할 수 있습니다. 본래 정규식의 수량 한정자에는 `{n, m}`을 사용하여 n ~ m 의 글자수 범위를 지정하는 기능이 있습니다. vim에서는 이 때 `\{-n, m}`을 사용하여 해당 범위 내에서 가능한 작은 수에 매칭하는 수량한정자를 지정할 수 있습니다. 독특하게 시작, 끝 범위를 모두 생략할 수 있습니다. 따라서, 다음과 같이 수량 한정자를 사용할 수 있습니다.

- 최소한 범위내의 임의의 문자 : `.*?` -> `.\{-}` 
- 1개 이상 범위 내에서 최소한의 문자`.+?` -> `.\{-1,}`

---

하는 김에 다른 차이점도 하나 더 짚어보겠습니다.

보통 검색이나 치환 명령을 사용할 때, vim에서는 기본적으로 라인 이내의 단위에서 범위를 잡고, 치환을 라인별로 반복하여 적용합니다. 그런데 경우에 따라서는 패턴 자체가 여러 라인에 걸치는 경우가 있습니다. 

예를 들어 긴 HTML 문서에서 `<article> ... </article>` 요소가 여러 라인에 걸쳐 있을 때, 이 요소를 삭제하려면 어떻게 할까요? 바로 `\` 패턴을 사용합니다. `\_.\+`는 개행을 포함한 임의의 문자의 연속을 의미합니다. 이를 수량한정자와 결합하여 다음과 같이 처리할 수 있습니다.

```
%s#<article>\_.\{-}<\/article>##
```

이 패턴은 특히 HTML 문서의 특정한 요소 내부를 선택하거나 수정해야 할 때, 매우 도움이 되는 기능입니다. 

### 참고 : vim의 HTML 모드의 페어 매치 플러그인

vim9의 내장 플러그인 중에는 `matchit`이 있습니다. vim은 원래 `%` 키를 사용하여 대응하는 괄호짝으로 커서를 즉시 이동할 수 있는데, `matchit` 플러그인은 이 기능을 언어별로 확장해줍니다. 여는 태그에서 `%` 키를 눌러 닫는 태그로 이동할 수 있고, `at`, `it` 텍스트 오브젝트 지시어를 사용해서 특정 태그의 내부나, 태그를 포함한 영역을 편집할 수 있게 됩니다. 

`matchit` 플러그인을 사용하기 위해서는 vimrc 파일에 다음 라인을 추가합니다. 

```vimscript
packadd! matchit
```

이 플러그인을 사용하면 위 어려운 정규식 문법을 몰라도 문제를 해결할 수 있습니다. 

### 참고 : 파이썬 정규식의 멀티라인 옵션

파이썬 등의 스크립트를 사용할 때에는 정규식을 적용하는 플래그를 통해, 여러 줄로 된 텍스트를 한 줄처럼 사용할 수 있습니다.

```python
import re

pat = r'\<article.*?\<\/article>'
s = "...."
result = re.sub(pat, "", s, flags=re.S)
```

![[Pasted image 20251022182322.png]]